<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Request Ticket Sheet Problem</title>
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" 
    rel="stylesheet" 
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" 
    crossorigin="anonymous" 
  />
  <style>
    form {
      font-size: 20px !important;
      width: min(800px, 90%);
    }
  </style>
</head>
<body>
  <form
    id="form"
    class="mx-auto my-5 shadow p-4"
    method="POST"
    
  >
    <!-- action will be set by JS -->
    <div class="mb-3 d-flex">
      <label class="mx-3" for="ID_GTR">ID GTR:</label>
      <input
        type="text"
        class="mx-3 form-control"
        id="ID_GTR"
        name="ID GTR"
        list="list_ID_GTR"
      />
      <datalist id="list_ID_GTR"></datalist>
    </div>

    <div class="mb-3 d-flex">
      <label class="mx-3" for="EMAIL">EMAIL:</label>
      <input
        type="text"
        class="mx-3 form-control"
        id="EMAIL"
        name="EMAIL"
        list="EMAILS"
      />
      <datalist id="EMAILS"></datalist>
    </div>

    <div class="mb-3 d-flex">
      <label class="mx-3" for="NAME">NAME:</label>
      <input
        type="text"
        class="mx-3 form-control"
        id="NAME"
        name="NAME"
        list="NAMES"
      />
      <datalist id="NAMES"></datalist>
    </div>

    <div class="mb-3 d-flex">
      <label class="mx-3" for="PROBLEM">PROBLEM:</label>
      <input
        type="text"
        class="mx-3 form-control"
        id="PROBLEM"
        name="PROBLEM"
        list="PROBLEMS"
      />
      <datalist id="PROBLEMS"></datalist>
    </div>

    <div class="mb-3 d-flex">
      <label class="mx-3" for="SHEET_NAME">SHEET NAME:</label>
      <input
        type="text"
        class="mx-3 form-control"
        id="SHEET_NAME"
        name="SHEET NAME"
        list="list_SHEET_NAME"
      />
      <datalist id="list_SHEET_NAME"></datalist>
    </div>

    <button type="submit" class="btn btn-primary">Submit</button>
  </form>

  <script>
    const url = "https://script.google.com/a/macros/groundteamred.com/s/AKfycbywq3UAdeNBnf9UdyaGqYuozOvfTqBimv3za-ALXAKOgEkZ-6qNZC38sEgwfgQSsper/exec";
    document.getElementById('form').action = url;

    // Datalists
    const fields = [
      { id: "list_ID_GTR", header: "ID GTR" },
      { id: "EMAILS", header: "EMAIL" },
      { id: "NAMES", header: "NAME" },
      { id: "PROBLEMS", header: "PROBLEM" },
      { id: "list_SHEET_NAME", header: "SHEET NAME" },
    ];

    fields.forEach(({ id, header }) => {
      fetch(`${url}?header=${encodeURIComponent(header)}`)
        .then((response) => response.json())
        .then(({ data }) => {
          populateDatalists(id, data);
        })
        .catch((error) => console.error(`Error fetching ${header}:`, error));
    });

    function populateDatalists(id, arr) {
      const options = arr.map(item => `<option value="${item}">`).join('');
      document.getElementById(id).innerHTML = options;
    }

    // Optional: show popup on successful form submit
    document.getElementById('form').addEventListener('submit', function () {
      alert("Form submitted successfully!");
    });
  </script>
</body>
</html>
